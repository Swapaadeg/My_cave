{% extends 'base.html.twig' %}

{% block title %}Ma cave{% endblock %}

{% block body %}
    <section class="cave-header container">
        <h1>{{ cave.nom ?? 'Ma cave' }}</h1>
        <a href="{{ path('edit_cave') }}" class="btn">Modifier ma cave</a>
        <a href="{{ path('bouteilles') }}" class="btn add">Ajouter des bouteilles à ma cave</a>
    </section>
    <section class="bouteilles-wrapper container" style="
        {% if cave.imageName %}
            background: url('{{ asset('uploads/images/' ~ cave.imageName) }}') no-repeat center center;
            width: 100%;
            background-size: cover;
            padding: 9rem 10rem;
        {% else %}
            background-color: #88002d1b;
        {% endif %}">

        {% if bouteilles is empty %}
            <p>Aucune bouteille dans votre cave pour le moment.</p>
        {% else %}
            <div class="bouteilles-grid">
                {% for bouteille in bouteilles %}
                    <div class="bouteille-card">
                        <div class="card-inner">
                            <div class="image-wrapper">
                                {% set image = bouteille.imageName
                                    ? 'uploads/images/' ~ bouteille.imageName
                                    : 'uploads/images/' ~ (
                                        bouteille.type == 'rouge' ? 'vin-rouge.jpg'
                                        : (bouteille.type == 'blanc' ? 'vin-blanc.jpg' : 'vin-rose.jpg')
                                    )
                                %}
                                <img src="{{ asset(image) }}" alt="{{ bouteille.nom }}">
                            </div>
                            <div class="infos">
                                <h2>{{ bouteille.nom }}</h2>
                                <div class="details">
                                    <p><strong>Millésime :</strong> {{ bouteille.millesime }}</p>
                                    <p><strong>Cépage :</strong> {{ bouteille.cepage }}</p>
                                    <p><strong>Type :</strong> {{ bouteille.type }}</p>
                                    <p><strong>Pays :</strong> {{ bouteille.pays }}</p>
                                    <p><strong>Région :</strong> {{ bouteille.region }}</p>
                                    <p class="description">{{ bouteille.description }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {# MODALE FLASH  #}
        {% for label, messages in app.flashes %}
            {% if label == 'success' %}
                <div class="modale-flash" id="modale-flash">
                    <div class="modale-content">
                        {% for message in messages %}
                            <p>{{ message }}</p>
                        {% endfor %}
                        <button class="modale-close" onclick="fermerModale()">Fermer</button>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </section>
    

{% endblock %}
